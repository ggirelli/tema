<!-- import url-specific style -->
<style type="text/css">@import "/public_html/SOGIv020/user_side/src/common/css/interface.css";</style>

<!-- url-specific template -->
<div id='interface' ng-app='sogi' ng-controller='interfaceController as iCtrl' ng-model='iCtrl'>

	<div id='left-bar'>

		<a class="title" href='#/'>SOGI</a>
		<span class="btn btn-primary btn-circle" ng-click="panels.toggle('graph_list')" ng-class="{'open' : panels.show.graph_list}" title="Network list">
			<span class="glyphicon glyphicon-th-list"></span>
		</span>
		<span class="btn btn-danger btn-circle" ng-click="panels.toggle('operations')" ng-class="{'open' : panels.show.operations}" title="Operations">
			<span class="glyphicon glyphicon-pencil"></span>
		</span>
		<span class="btn btn-success btn-circle" ng-click="panels.toggle('attributes')" ng-class="{'open' : panels.show.attributes}" title="Attributes">
			<span class="glyphicon glyphicon-tags"></span>
		</span>
		<span class="btn btn-success btn-circle" ng-click="panels.toggle('select')" ng-class="{'open' : panels.show.select}" title="Select">
			<span class="glyphicon glyphicon-check"></span>
		</span>
		<span class="btn btn-warning btn-circle" ng-click="panels.toggle('layout')" ng-class="{'open' : panels.show.layout}" title="Layout">
			<span class="glyphicon glyphicon-th"></span>
		</span>
		<span class="btn btn-warning btn-circle" ng-click="panels.toggle('style')" ng-class="{'open' : panels.show.style}" title="Style">
			<span class="glyphicon glyphicon-adjust"></span>
		</span>
		<span class="btn btn-default btn-circle" ng-click="panels.toggle('settings')" ng-class="{'open' : panels.show.settings}" title="Settings">
			<span class="glyphicon glyphicon-cog"></span>
		</span>
		<a href="#/help" class="btn btn-info btn-circle" title="Help">
			<span class="glyphicon glyphicon-heart-empty"></span>
		</a>

	</div>

	<div class='left-panel-wrap'>

		<div class='left-panel graph-list-panel panel panel-primary' ng-show='panels.show.graph_list'>
			<div class="panel-heading">
				Network list
				<a href='#/upload/{{m.session_id}}' class="btn-panel glyphicon glyphicon-cloud-upload float-right" title='Upload'></a>
				<a href="#/interface/{{m.session_id}}" class="btn-panel glyphicon glyphicon-refresh float-right" title='Refresh' ng-click="networks.reload_list(m.session_id)"></a>
				<a href="#/interface/{{m.session_id}}" class="btn-panel glyphicon glyphicon-transfer float-right" title="Convert" ng-click="networks.toggle_convert_many(m.session_id)"></a>
				<a href="#/interface/{{m.session_id}}" class="btn-panel glyphicon glyphicon-floppy-disk float-right" title="Save" ng-click="canvas.save(m.session_id, networks.list)"></a>
			</div>

			<div class="panel-body" ng-show="!networks.is_converting_many()">
				<div class="alert" ng-show='networks.list != null' ng-repeat='net in networks.list' ng-class="{'alert-info' : networks.isConverted(net)&&!canvas.isLoaded(net.name), 'alert-danger' : !networks.isConverted(net), 'alert-success' : canvas.isLoaded(net.name)}">
					<a href="#/interface/{{m.session_id}}" class="load-network-link" ng-class="{'text-danger' : !networks.isConverted(net), 'text-success' : canvas.isLoaded(net.name)}" ng-click="networks.init_file(net)" title="N: {{net.data.v_count}} | E: {{net.data.e_count}}">{{net.name}} <span class="glyphicon glyphicon-flag" ng-show="!networks.isConverted(net)"></span><span class="glyphicon glyphicon-eye-open" ng-show="canvas.isLoaded(net.name)"></span></a>
					<!-- overwrite -->
					<a href="#/interface/{{m.session_id}}" ng-class="{'text-danger' : !networks.isConverted(net)}" class="net-action float-right" title='Overwrite' ng-click="networks.overwrite(m.session_id, net.id)"><span class="glyphicon glyphicon-import"></span></a>
					<!-- remove -->
					<a href="#/interface/{{m.session_id}}" ng-class="{'text-danger' : !networks.isConverted(net)}" class="net-action float-right" title='Remove' ng-click="networks.remove(m.session_id, net.id)"><span class="glyphicon glyphicon-trash"></span></a>
					<!-- rename -->
					<a href="#/interface/{{m.session_id}}" ng-class="{'text-danger' : !networks.isConverted(net)}" class="net-action float-right" title='Rename' ng-click="networks.rename(m.session_id, net.id)"><span class="glyphicon glyphicon-pencil"></span></a>
					<!-- download -->
					<a href="#/interface/{{m.session_id}}" ng-class="{'text-danger' : !networks.isConverted(net)}" class="net-action float-right" title='Download' ng-click="networks.download(m.session_id, net.id)"><span class="glyphicon glyphicon-cloud-download"></span></a>
					<!-- inspect -->
					<a href="#/interface/{{m.session_id}}" ng-class="{'text-danger' : !networks.isConverted(net)}" class="net-action float-right" title='Inspect' ng-click="networks.inspect(net.id)"><span class="glyphicon glyphicon-search"></span></a>
				</div>

				<p ng-show='networks.list == null'>
					<i>You have not uploaded any network yet...</i><br />
					Visit the <a href="#/upload/{{m.session_id}}">uploader</a>!
				</p>
			</div>

			<div class="panel-body" ng-show="networks.is_converting_many()">
				<input type="checkbox" id="all" name="all" ng-model="networks.converting_many.all" ng-click="networks.un_select_all()" />
				<label class="alert alert-warning" for="all">Un/Select all</label>

				<div ng-repeat='net in networks.list | filter:networks.isToConvert'>
					<input id="net-{{net.id}}" name="net-{{net.id}}" type="checkbox" ng-model="networks.converting_many.networks[net.name]" ng-click="networks.check_selection(net.name)" />
					<label for="net-{{net.id}}" class="alert" ng-show='networks.list != null' ng-class="{'alert-info' : networks.isConverted(net), 'alert-danger' : !networks.isConverted(net)}">
						{{net.name}}
					</label>
				</div>

				<button class="btn btn-convert_many btn-sm btn-success" ng-click="networks.start_converting_many()">convert selection</button>
			</div>
		</div>


		<div class='left-panel operations-panel panel panel-danger' ng-show='panels.show.operations'>
			<div class="panel-heading">Operations</div>
			<div class="panel-body">

				<div class="btn operation-btn btn-danger btn-block" ng-show="!commander.operation.status" ng-click="commander.init_operation('merge')">
					Merge networks
				</div>
				<div class="panel operation-panel panel-danger" ng-show="commander.is_operation('merge')">
					<div class="panel-heading">Merge networks</div>
					<div class="panel-body">
						<p>
							Select the networks to merge them!
						</p>

						<p>
							<span class="single-network-select" ng-repeat="net in networks.list">
								<input id="check-{{net.id}}" name="check-{{net.id}}" type="checkbox" ng-model="commander.operation.selected[net.id]"> <label for="check-{{net.id}}">{{net.name}}</label>
							</span>
						</p>

						<button class="btn end-btn btn-success" ng-click='commander.merge()'>merge</button><button class="btn end-btn btn-danger" ng-click='commander.abort_operation()'>abort</button>
					</div>
				</div>

				<div class="btn operation-btn btn-danger btn-block" ng-show="!commander.operation.status" ng-click="commander.init_operation('intersect')">
					Intersect networks
				</div>
				<div class="panel operation-panel panel-danger" ng-show="commander.is_operation('intersect')">
					<div class="panel-heading">Intersect networks</div>
					<div class="panel-body">
						Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit assumenda corporis officia reiciendis, possimus delectus laboriosam, magnam obcaecati enim. Dolorum autem animi, culpa fugiat eveniet expedita ad aut commodi beatae?
						<button class="btn end-btn btn-danger" ng-click='commander.abort_operation()'>abort</button>
					</div>
				</div>

				<div class="btn operation-btn btn-danger btn-block" ng-show="!commander.operation.status" ng-click="commander.init_operation('subtract')">
					Subtract networks
				</div>
				<div class="panel operation-panel panel-danger" ng-show="commander.is_operation('subtract')">
					<div class="panel-heading">Subtract networks</div>
					<div class="panel-body">
						Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit assumenda corporis officia reiciendis, possimus delectus laboriosam, magnam obcaecati enim. Dolorum autem animi, culpa fugiat eveniet expedita ad aut commodi beatae?
						<button class="btn end-btn btn-danger" ng-click='commander.abort_operation()'>abort</button>
					</div>
				</div>

				<div class="btn operation-btn btn-info btn-block" ng-show="!commander.operation.status" ng-click="commander.init_operation('contains')">
					is Subnetwork
				</div>
				<div class="panel operation-panel panel-info" ng-show="commander.is_operation('contains')">
					<div class="panel-heading">is Subnetwork</div>
					<div class="panel-body">
						Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit assumenda corporis officia reiciendis, possimus delectus laboriosam, magnam obcaecati enim. Dolorum autem animi, culpa fugiat eveniet expedita ad aut commodi beatae?
						<button class="btn end-btn btn-danger" ng-click='commander.abort_operation()'>abort</button>
					</div>
				</div>
			</div>
		</div>

		<div class='left-panel attributes-panel panel panel-success' ng-show='panels.show.attributes'>
			<div class="panel-heading">
				<span ng-show="!networks.is_attr_doing()">
					Attributes
					<a href="#/interface/{{m.session_id}}" class="btn-panel text-success float-right" ng-click="networks.do_attr('add_new')" title="Add new"><span class="glyphicon glyphicon-plus"></span></a>
					<a href="#/interface/{{m.session_id}}" class="btn-panel text-success float-right" ng-click="networks.do_attr('combine')" title="Combine"><span class="glyphicon glyphicon-resize-small"></span></a>
				</span>
				<span ng-show="networks.is_attr_doing('add_new')">Add new attribute</span>
				<span ng-show="networks.is_attr_doing('combine')">Combine attributes</span>
				<span ng-show="networks.is_attr_doing('rename')">Rename attribute</span>
				<span ng-show="networks.is_attr_doing('remove')">Remove attribute</span>
				<span ng-show="networks.is_attr_doing('replace')">Replace attribute</span>
			</div>
			<div class="panel-body">

				<div ng-show="!networks.is_attr_doing()">
					<h4>Node attributes:</h4>
					<div class="alert alert-info" ng-repeat="attr in canvas.get_attributes('nodes')">
						{{attr}}
						<!-- overwrite -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Overwrite' ng-click="networks.do_attr('overwrite'); networks.attributes.options.type='nodes'; networks.attributes.options.name=attr;"><span class="glyphicon glyphicon-import"></span></a>
						<!-- remove -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Remove' ng-click="networks.attr_remove(m.session_id, attr, 'nodes')"><span class="glyphicon glyphicon-trash"></span></a>
						<!-- rename -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Rename' ng-click="networks.attr_rename(m.session_id, attr, 'nodes')"><span class="glyphicon glyphicon-pencil"></span></a>
					</div>
					<hr style="margin-bottom: 2em;" />
					<h4>Edge attributes:</h4>
					<div class="alert alert-info" ng-repeat="attr in canvas.get_attributes('edges')">
						{{attr}}
						<!-- overwrite -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Overwrite' ng-click="networks.do_attr('overwrite'); networks.attributes.options.type='edges'; networks.attributes.options.name=attr;"><span class="glyphicon glyphicon-import"></span></a>
						<!-- remove -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Remove' ng-click="networks.attr_remove(m.session_id, attr, 'edges')"><span class="glyphicon glyphicon-trash"></span></a>
						<!-- rename -->
						<a href="#/interface/{{m.session_id}}" class="attr-action float-right" title='Rename' ng-click="networks.attr_rename(m.session_id, attr, 'edges')"><span class="glyphicon glyphicon-pencil"></span></a>
					</div>
					<hr />
				</div>

				<!-- add_new -->
				<div ng-show="networks.is_attr_doing('add_new')">
					
					<h4>
						Add <select name="attr_input" id="attr_input" ng-model="networks.attributes.options.input">
							<option value="">--</option>
							<option value="manual">manually</option>
							<option value="index">index as</option>
						</select> new 
						<select name="attr_type" id="attr_type" ng-model="networks.attributes.options.type">
							<option value="" ng-show="'manual' == networks.attributes.options.input">--</option>
							<option value="edges" ng-show="'manual' == networks.attributes.options.input">edge</option>
							<option value="nodes" ng-show="-1 != ['manual', 'index'].indexOf(networks.attributes.options.input)" ng-selected="'index' == networks.attributes.options.input">node</option>
						</select>
						attribute.
					</h4>
					<p ng-show="-1 != ['manual', 'index'].indexOf(networks.attributes.options.input)">
						<label for="attr_name">Attribute name: </label>
						<input class="form-control" type="text" id="attr_name" name="attr_name" ng-model="networks.attributes.options.name" />
					</p>
					<p ng-show="'manual' == networks.attributes.options.input">
						<label for="attr_values">Comma Separated Values:</label>
						<textarea class="form-control" name="attr_values" id="attr_values" cols="40" rows="10" ng-model="networks.attributes.options.values"></textarea>
					</p>
					<p ng-show="'index' == networks.attributes.options.input">
						<label for="index">Select index:</label>
						<select name="index" id="index" ng-model="networks.attributes.options.index">
							<option value="">--</option>
							<option value="degree">degree</option>
							<option value="betweenness">betweenness</option>
							<option value="closeness">closeness</option>
						</select>
					</p>

					<p class="alert alert-danger" ng-repeat="msg in networks.attributes.options.errMsg">{{msg}}</p>

					<button class="btn abort-btn btn-success" ng-click="networks.attr_apply(m.session_id, 'add_new')">apply</button> <button class="btn abort-btn btn-danger" ng-click="networks.do_attr(null)">abort</button>
				</div>
				<!-- combine -->
				<div ng-show="networks.is_attr_doing('combine')">
					<h4>
						Combine 
						<select name="attr_type" id="attr_type" ng-model="networks.attributes.options.type">
							<option value="">--</option>
							<option value="edges">edge</option>
							<option value="nodes">node</option>
						</select>
						attributes.
					</h4>
					<hr>
					<p>
						<label for="attr_name">New attribute name: </label>
						<input class="form-control" type="text" id="attr_name" name="attr_name" ng-model="networks.attributes.options.name" />
					</p>
					<hr>
					<div ng-show="null != networks.attributes.options.type">
						<h4>Select the attributes that you want to combine:</h4>
						<label class="attr-list alert" ng-class="{'alert-info' : !networks.attributes[networks.attributes.options.type][attr], 'alert-success' : networks.attributes[networks.attributes.options.type][attr]}" for="attr-{{attr}}" ng-repeat="attr in canvas.get_attributes(networks.attributes.options.type)">
							<input type="checkbox" id="attr-{{attr}}" name="attr-{{attr}}" ng-model="networks.attributes[networks.attributes.options.type][attr]"> {{attr}}
						</label>
					</div>
					<hr>
					<div ng-show="networks.attr_selected()">
						<h4>Write a function in R code:</h4>
						<textarea class="form-control" name="attr_function" id="attr_function" cols="40" rows="5" ng-model="networks.attributes.options.function" placeholder="_0_*log(_1_)"></textarea>
						<h4>In the function use the attributes as follows:</h4>
						<ul>
							<li ng-repeat="attr in networks.attr_get_selected()"><code>{{attr}}</code> as <code>_{{$index}}_</code></li>
						</ul>
					</div>

					<p class="alert alert-danger" ng-repeat="msg in networks.attributes.options.errMsg">{{msg}}</p>

					<button class="btn abort-btn btn-success" ng-click="networks.attr_apply(m.session_id, 'combine')">apply</button> <button class="btn abort-btn btn-danger" ng-click="networks.do_attr(null)">abort</button>
				</div>
				<!-- overwrite -->
				<div ng-show="networks.is_attr_doing('overwrite')">
					
					<h4>
						Owerwrite <select name="attr_input" id="attr_input" ng-model="networks.attributes.options.input">
							<option value="">--</option>
							<option value="manual">manually</option>
							<option value="index" ng-show="'nodes' == networks.attributes.options.type">with index</option>
						</select>.
					</h4>
					<p ng-show="'manual' == networks.attributes.options.input">
						<label for="attr_values">Comma Separated Values:</label>
						<textarea class="form-control" name="attr_values" id="attr_values" cols="40" rows="10" ng-model="networks.attributes.options.values"></textarea>
					</p>
					<p ng-show="'index' == networks.attributes.options.input">
						<label for="index">Select index:</label>
						<select name="index" id="index" ng-model="networks.attributes.options.index">
							<option value="">--</option>
							<option value="degree">degree</option>
							<option value="betweenness">betweenness</option>
							<option value="closeness">closeness</option>
						</select>
					</p>

					<p class="alert alert-danger" ng-repeat="msg in networks.attributes.options.errMsg">{{msg}}</p>

					<button class="btn abort-btn btn-success" ng-click="networks.attr_apply(m.session_id, 'add_new')">apply</button> <button class="btn abort-btn btn-danger" ng-click="networks.do_attr(null)">abort</button>
				</div>

				<p class="footnote">
					All the changes applied to the attributes are applied only
					to the current visualization and are not saved on the server.
					To do so, please use the <u><i>overwrite</i></u> or the <u><i>save</i></u> functions.
				</p>

			</div>
		</div>

		<div class='left-panel select-panel panel panel-success' ng-show='panels.show.select'>
			<div class="panel-heading">Select</div>
			<div class="panel-body">
				...
			</div>
		</div>

		<div class='left-panel layout-panel panel panel-warning' ng-show='panels.show.layout'>
			<div class="panel-heading">Layout</div>
			<div class="panel-body">
				
				<button type="button" class="btn btn-warning btn-md" ng-click="canvas.layout({name:'circle'})" >
					<span class="glyphicon glyphicon-repeat"></span>
				</button>
				<button type="button" class="btn btn-warning btn-md" ng-click="canvas.layout({name:'grid'})">
					<span class="glyphicon glyphicon-th"></span>
				</button>
				<button type="button" class="btn btn-warning btn-md" ng-click="canvas.layout({name:'breadthfirst'})">
					<span class="glyphicon glyphicon-tree-deciduous"></span>
				</button>
				<button type="button" class="btn btn-warning btn-md" ng-click="canvas.layout({name:'random'})">
					<span class="glyphicon glyphicon-asterisk"></span>
				</button>
				<button type="button" class="btn btn-danger btn-md" ng-click="canvas.center()">
					<span class="glyphicon glyphicon-screenshot"></span>
				</button>

			</div>
		</div>

		<div class='left-panel style-panel panel panel-warning' ng-show='panels.show.style'>
			<div class="panel-heading">Style</div>
			<div class="panel-body">
				...
			</div>
		</div>

		<div class='left-panel settings-panel panel panel-default' ng-show='panels.show.settings'>
			<div class="panel-heading">Settings</div>
			<div class="panel-body">

				<h4>Sample Info File</h4>

				<!-- SIF -->
				<div ng-show="!settings.is_sif_ready()">
					<button class="btn btn-default" ng-click="settings.upload_sif(m.session_id)">Upload SIF</button>
					<input type="file" id="sif-input" class='hidden-file-input' />
				</div>

				<div ng-show="settings.is_sif_ready()">
					SIF sample column:
					<select name="" id="" ng-model="settings.info.sif_sample_col">
						<option value="">Select a column</option>
						<option value="{{k}}" ng-repeat="k in settings.info.sif_keys" ng-selected="settings.is_sif_sample_col(k)">{{k}}</option>
					</select>
				</div>

				<hr />

				<h4>Visualization</h4>

				<!-- node_threshold -->
				<div>
					<label for="node_thr">Node threshold: </label>
					<input id="node_thr" name="node_thr" type="number" ng-model="settings.info.node_thr" />
				</div>

				<hr />

				<h4>Gene Ontologies</h4>

				<!-- GO files -->
				<div>
					<label for="goa-input">GO basic: </label>
					<button class="btn btn-default btn-block" ng-click="settings.upload_goa(m.session_id)" ng-show="!settings.is_goa_ready()">Upload GOA</button>
					<div ng-show="settings.is_goa_ready()">
						<span>{{settings.info.goa}}</span>
						<button class="btn btn-default btn-block" ng-click="settings.upload_goa(m.session_id)">Change GOA</button>
					</div>
					<input type="file" id="goa-input" name="goa-input" class='hidden-file-input' />
				</div>

				<br />

				<div>
					<label for="gob-input">GO annotations: </label>
					<button class="btn btn-default btn-block" ng-click="settings.upload_gob(session_id)" ng-show="!settings.is_gob_ready()">Upload GOB</button>
					<div ng-show="settings.is_gob_ready()">
						<span>{{settings.info.gob}}</span>
						<button class="btn btn-default btn-block" ng-click="settings.upload_gob(session_id)">Change GOB</button>
					</div>
					<input type="file" id="gob-input" name="gob-input" class='hidden-file-input' />
				</div>

				<br />

				<div>
					<label for="go_status">Status: </label>
					<span class="text-success" ng-show="settings.info.go_status">ready</span>
					<span class="text-danger" ng-show="!settings.info.go_status">wating</span>
				</div>

				<hr />

				<!-- save_button -->
				<button class="btn btn-apply btn-sm btn-success" ng-click="settings._apply(m.session_id)">apply</button>
			</div>
		</div>

	</div>

	<div id='bottom-bar' ng-click='panels.closeAll()'>
		<div class="col-md-12 wrap">

			<div id="console" class='col-md-5'>
				<input type='text' class='terminal' /><button class='btn btn-info'><span class="glyphicon glyphicon-forward"></span></button>
			</div>
			
			<div id="inspector" class="col-md-4 col-md-offset-2 panel panel-info" ng-show='inspector.show'>
				<div class="panel-heading">Inspector</div>
				<div class="panel-body">
					
					<div ng-show="inspector.is_inspecting('network')">
						<p><b>Name: </b>{{inspector.inspecting.network.name}}</p>

						<p><b>Nodes: </b>{{inspector.inspecting.network.data.v_count}}</p>
						<p><b>Node attributes:</b></p>
						<ul><li ng-repeat="attr in inspector.inspecting.network.data.v_attributes">{{attr}}</li></ul>

						<p><b>Edges: </b>{{inspector.inspecting.network.data.e_count}}</p>
						<p><b>Edge attributes:</b></p>
						<ul><li ng-repeat="attr in inspector.inspecting.network.data.e_attributes">{{attr}}</li></ul>

						<p><b>Single-sample: </b>{{inspector.inspecting.network.single}}</p>

						<br />
						<div ng-show="inspector.inspecting.network.single">
							<h4>SIF data</h4>
							<p ng-repeat="(key, value) in inspector.inspecting.network.sif_data">
								<b>{{key}}: </b>{{value}}
							</p>
						</div>
						<br />
					</div>

				</div>
			</div>
		</div>
	</div>

	<div id="canvas" ng-click='panels.closeAll(); inspector.close();'>
		
	</div>

</div>
